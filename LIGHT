local player = game.Players.LocalPlayer
local lighting = game:GetService("Lighting")

-- T·∫°o menu ch√≠nh (·∫©n ƒëi khi ch∆∞a nh·∫≠p key)
local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 200, 0, 100)
frame.Position = UDim2.new(0.5, -100, 0.5, -50)
frame.BackgroundColor3 = Color3.new(1, 1, 0)  -- M√†u n·ªÅn v√†ng
frame.BorderSizePixel = 0

-- T·∫°o n√∫t b·∫≠t/t·∫Øt
local toggleButton = Instance.new("TextButton", frame)
toggleButton.Size = UDim2.new(0, 100, 0, 50)
toggleButton.Position = UDim2.new(0.25, 0, 0.25, 0)
toggleButton.Text = "üî¶"
toggleButton.BackgroundColor3 = Color3.new(0.7, 0.7, 0.7)  -- M√†u x√°m
toggleButton.TextColor3 = Color3.new(1, 1, 1)

-- T·∫°o n√∫t x√≥a
local deleteButton = Instance.new("TextButton", frame)
deleteButton.Size = UDim2.new(0, 20, 0, 20)
deleteButton.Position = UDim2.new(0, 0, 0, 0)
deleteButton.Text = "X"
deleteButton.BackgroundColor3 = Color3.new(1, 0, 0)
deleteButton.TextColor3 = Color3.new(1, 1, 1)

-- Bi·∫øn ƒë·ªÉ theo d√µi tr·∫°ng th√°i b·∫≠t/t·∫Øt
local isLightEnabled = false

-- X·ª≠ l√Ω khi nh·∫•n n√∫t b·∫≠t/t·∫Øt
toggleButton.MouseButton1Click:Connect(function()
    isLightEnabled = not isLightEnabled
    if isLightEnabled then
        -- Khi b·∫≠t, ch·ªânh √°nh s√°ng ƒë·ªÉ nh√¨n r√µ nh∆∞ ban ng√†y
        lighting.Brightness = 77
        lighting.Ambient = Color3.new(1, 1, 1)
        lighting.FogEnd = 1e6
        toggleButton.Text = "üî¶üí°"
        toggleButton.BackgroundColor3 = Color3.new(0, 0.8, 0)  -- M√†u xanh khi b·∫≠t
    else
        -- Khi t·∫Øt, ƒë∆∞a √°nh s√°ng v·ªÅ tr·∫°ng th√°i b√¨nh th∆∞·ªùng
        lighting.Brightness = 1
        lighting.Ambient = Color3.new(0.5, 0.5, 0.5)
        lighting.FogEnd = 1000
        toggleButton.Text = "üî¶"
        toggleButton.BackgroundColor3 = Color3.new(0.7, 0.7, 0.7)  -- M√†u x√°m khi t·∫Øt
    end
end)

-- X·ª≠ l√Ω khi nh·∫•n n√∫t x√≥a
deleteButton.MouseButton1Click:Connect(function()
    frame:Destroy()  -- X√≥a menu ch√≠nh
end)

-- T√≠nh nƒÉng di chuy·ªÉn menu ch√≠nh b·∫±ng chu·ªôt
local dragging
local dragInput
local dragStart
local startPos

local function updateInput(input)
    local delta = input.Position - dragStart
    frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = frame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

frame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if dragging and input == dragInput then
        updateInput(input)
    end
end)
