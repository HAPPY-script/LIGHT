local player = game.Players.LocalPlayer
local lighting = game:GetService("Lighting")

-- T·∫°o GUI
local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))

-- T·∫°o menu nh·∫≠p key
local keyFrame = Instance.new("Frame", gui)
keyFrame.Size = UDim2.new(0, 300, 0, 150)
keyFrame.Position = UDim2.new(0.5, -150, 0.5, -75)
keyFrame.BackgroundColor3 = Color3.new(1, 1, 0)  -- M√†u n·ªÅn v√†ng
keyFrame.BorderSizePixel = 0

local keyBox = Instance.new("TextBox", keyFrame)
keyBox.Size = UDim2.new(0, 280, 0, 50)
keyBox.Position = UDim2.new(0.5, -140, 0.2, 0)
keyBox.PlaceholderText = "Nh·∫≠p key ·ªü ƒë√¢y"
keyBox.TextScaled = true

local submitButton = Instance.new("TextButton", keyFrame)
submitButton.Size = UDim2.new(0, 100, 0, 50)
submitButton.Position = UDim2.new(0.5, -50, 0.6, 0)
submitButton.Text = "X√°c Nh·∫≠n"
submitButton.BackgroundColor3 = Color3.new(0, 0.8, 0)  -- M√†u xanh

local errorLabel = Instance.new("TextLabel", keyFrame)
errorLabel.Size = UDim2.new(1, 0, 0.2, 0)
errorLabel.Position = UDim2.new(0, 0, 0.85, 0)
errorLabel.TextColor3 = Color3.new(1, 0, 0)
errorLabel.TextScaled = true
errorLabel.Text = ""

-- T·∫°o menu ch√≠nh (·∫©n ƒëi khi ch∆∞a nh·∫≠p key)
local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 200, 0, 100)
frame.Position = UDim2.new(0.5, -100, 0.5, -50)
frame.BackgroundColor3 = Color3.new(1, 1, 0)  -- M√†u n·ªÅn v√†ng
frame.BorderSizePixel = 0
frame.Visible = false  -- ·∫®n menu ch√≠nh khi ch∆∞a nh·∫≠p key ƒë√∫ng

-- T·∫°o n√∫t b·∫≠t/t·∫Øt
local toggleButton = Instance.new("TextButton", frame)
toggleButton.Size = UDim2.new(0, 100, 0, 50)
toggleButton.Position = UDim2.new(0.25, 0, 0.25, 0)
toggleButton.Text = "üî¶"
toggleButton.BackgroundColor3 = Color3.new(0.7, 0.7, 0.7)  -- M√†u x√°m
toggleButton.TextColor3 = Color3.new(1, 1, 1)

-- T·∫°o n√∫t x√≥a
local deleteButton = Instance.new("TextButton", frame)
deleteButton.Size = UDim2.new(0, 20, 0, 20)
deleteButton.Position = UDim2.new(0, 0, 0, 0)
deleteButton.Text = "X"
deleteButton.BackgroundColor3 = Color3.new(1, 0, 0)
deleteButton.TextColor3 = Color3.new(1, 1, 1)

-- Bi·∫øn ƒë·ªÉ theo d√µi tr·∫°ng th√°i b·∫≠t/t·∫Øt
local isLightEnabled = false

-- X·ª≠ l√Ω khi nh·∫•n n√∫t b·∫≠t/t·∫Øt
toggleButton.MouseButton1Click:Connect(function()
    isLightEnabled = not isLightEnabled
    if isLightEnabled then
        -- Khi b·∫≠t, ch·ªânh √°nh s√°ng ƒë·ªÉ nh√¨n r√µ nh∆∞ ban ng√†y
        lighting.Brightness = 100
        lighting.Ambient = Color3.new(1, 1, 1)
        lighting.FogEnd = 1e6
        toggleButton.Text = "üî¶üí°"
        toggleButton.BackgroundColor3 = Color3.new(0, 0.8, 0)  -- M√†u xanh khi b·∫≠t
    else
        -- Khi t·∫Øt, ƒë∆∞a √°nh s√°ng v·ªÅ tr·∫°ng th√°i b√¨nh th∆∞·ªùng
        lighting.Brightness = 1
        lighting.Ambient = Color3.new(0.5, 0.5, 0.5)
        lighting.FogEnd = 1000
        toggleButton.Text = "üî¶"
        toggleButton.BackgroundColor3 = Color3.new(0.7, 0.7, 0.7)  -- M√†u x√°m khi t·∫Øt
    end
end)

-- X·ª≠ l√Ω khi nh·∫•n n√∫t x√≥a
deleteButton.MouseButton1Click:Connect(function()
    frame:Destroy()  -- X√≥a menu ch√≠nh
end)

-- T√≠nh nƒÉng di chuy·ªÉn menu ch√≠nh b·∫±ng chu·ªôt
local dragging
local dragInput
local dragStart
local startPos

local function updateInput(input)
    local delta = input.Position - dragStart
    frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = frame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

frame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if dragging and input == dragInput then
        updateInput(input)
    end
end)

-- X·ª≠ l√Ω khi nh·∫≠p key
submitButton.MouseButton1Click:Connect(function()
    if keyBox.Text == "HAPPY_FAMILY" then
        keyFrame:Destroy()  -- X√≥a menu nh·∫≠p key
        frame.Visible = true  -- Hi·ªÉn th·ªã menu ch√≠nh khi nh·∫≠p ƒë√∫ng key
    else
        errorLabel.Text = "Key kh√¥ng ƒë√∫ng!"
    end
end)
